<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Destination | AI Travel Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            accent: '#3b82f6',
                            highlight: '#f43f5e'
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar for clean look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .activity-card {
            transition: all 0.3s ease;
        }
        .activity-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .hidden-input {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            opacity: 0;
        }
        .hidden-input.show {
            max-height: 100px;
            opacity: 1;
            margin-top: 0.75rem;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-brand-dark text-white p-4 sticky top-0 z-50 shadow-lg">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fas fa-globe-americas text-brand-accent text-2xl"></i>
                <h1 class="text-2xl font-bold font-serif tracking-wide">Ultimate Destination</h1>
            </div>
            <div class="hidden md:flex gap-6 text-sm font-medium">
                <a href="#" class="hover:text-brand-accent transition">My Trips</a>
                <a href="#" class="hover:text-brand-accent transition">Community</a>
                <a href="#" class="hover:text-brand-accent transition">Account</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow">
        
        <!-- Hero / Input Section -->
        <section id="input-section" class="relative bg-brand-dark py-16 md:py-24 overflow-hidden">
            <!-- Background Image overlay -->
            <div class="absolute inset-0 opacity-30">
                <img src="https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?ixlib=rb-4.0.3&auto=format&fit=crop&w=2021&q=80" alt="Travel" class="w-full h-full object-cover">
            </div>
            
            <div class="relative max-w-5xl mx-auto px-4 text-center">
                <h2 class="text-4xl md:text-6xl font-serif text-white mb-6 font-bold leading-tight">
                    Your Dream Vacation, <br><span class="text-brand-accent">AI Generated.</span>
                </h2>
                <p class="text-slate-300 text-lg mb-10 max-w-2xl mx-auto">
                    Tell us where you want to go, who you're with, and when. Our engine builds a personalized, age-appropriate itinerary with live details.
                </p>

                <!-- Configuration Form -->
                <div class="glass-panel rounded-2xl p-6 md:p-8 text-left shadow-2xl max-w-4xl mx-auto transform transition-all">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        
                        <!-- Destination -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-bold text-slate-700 mb-2">Destination</label>
                            <div class="relative">
                                <i class="fas fa-map-marker-alt absolute left-3 top-3 text-slate-400"></i>
                                <select id="destination" onchange="toggleCustomDest()" class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-white appearance-none cursor-pointer">
                                    <optgroup label="United States">
                                        <option value="new-york">New York City, NY</option>
                                        <option value="los-angeles">Los Angeles, CA</option>
                                        <option value="chicago">Chicago, IL</option>
                                        <option value="miami">Miami, FL</option>
                                        <option value="san-francisco">San Francisco, CA</option>
                                        <option value="las-vegas">Las Vegas, NV</option>
                                        <option value="honolulu">Honolulu, HI</option>
                                    </optgroup>
                                    <optgroup label="International">
                                        <option value="toronto">Toronto, Canada</option>
                                        <option value="paris">Paris, France</option>
                                        <option value="london">London, UK</option>
                                        <option value="berlin">Berlin, Germany</option>
                                        <option value="tokyo">Tokyo, Japan</option>
                                        <option value="seoul">Seoul, South Korea</option>
                                        <option value="rome">Rome, Italy</option>
                                        <option value="barcelona">Barcelona, Spain</option>
                                        <option value="amsterdam">Amsterdam, Netherlands</option>
                                        <option value="sydney">Sydney, Australia</option>
                                        <option value="bangkok">Bangkok, Thailand</option>
                                        <option value="dubai">Dubai, UAE</option>
                                        <option value="rio">Rio de Janeiro, Brazil</option>
                                        <option value="capetown">Cape Town, South Africa</option>
                                    </optgroup>
                                    <option value="custom">Other / Custom Location...</option>
                                </select>
                            </div>
                            <div id="custom-dest-container" class="hidden-input">
                                <input type="text" id="custom-dest-val" placeholder="Enter City Name (e.g. Rio de Janeiro)" class="w-full px-4 py-2 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-slate-50">
                            </div>
                        </div>

                        <!-- Start Date -->
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Start Date</label>
                            <div class="relative">
                                <input type="date" id="start-date" class="w-full px-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-white text-slate-700">
                            </div>
                        </div>

                        <!-- Duration -->
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Duration</label>
                            <div class="relative">
                                <i class="fas fa-calendar-alt absolute left-3 top-3 text-slate-400"></i>
                                <select id="duration" class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-white appearance-none cursor-pointer">
                                    <option value="1">1 Day</option>
                                    <option value="3" selected>3 Days</option>
                                    <option value="5">5 Days</option>
                                    <option value="7">7 Days</option>
                                </select>
                            </div>
                        </div>

                        <!-- Age Group -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-bold text-slate-700 mb-2">Who is traveling?</label>
                            <div class="relative">
                                <i class="fas fa-user-group absolute left-3 top-3 text-slate-400"></i>
                                <select id="age-group" class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-white appearance-none cursor-pointer" onchange="toggleNightlife()">
                                    <option value="family">Family (Kids under 18) - Safe & Fun</option>
                                    <option value="young-adult">Young Adults (18-30) - Trendy</option>
                                    <option value="adult">Adults (30-55) - Balanced</option>
                                    <option value="senior">Seniors (55+) - Relaxed</option>
                                </select>
                            </div>
                        </div>

                        <!-- Budget -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-bold text-slate-700 mb-2">Budget</label>
                            <div class="relative">
                                <i class="fas fa-tag absolute left-3 top-3 text-slate-400"></i>
                                <select id="budget" class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-brand-accent focus:border-transparent bg-white appearance-none cursor-pointer">
                                    <option value="economy">Economy ($)</option>
                                    <option value="standard" selected>Standard ($$)</option>
                                    <option value="luxury">Luxury ($$$)</option>
                                </select>
                            </div>
                        </div>

                    </div>

                    <!-- Interests -->
                    <div class="mb-8">
                        <label class="block text-sm font-bold text-slate-700 mb-3">Interests (Select at least one)</label>
                        <div class="flex flex-wrap gap-3">
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="culture" checked class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-brand-accent peer-checked:text-white peer-checked:border-brand-accent transition hover:bg-slate-50 peer-checked:hover:bg-blue-600">
                                    <i class="fas fa-landmark mr-1"></i> Culture
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="history" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-amber-600 peer-checked:text-white peer-checked:border-amber-600 transition hover:bg-slate-50 peer-checked:hover:bg-amber-700">
                                    <i class="fas fa-scroll mr-1"></i> History
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="food" checked class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-emerald-500 peer-checked:text-white peer-checked:border-emerald-500 transition hover:bg-slate-50 peer-checked:hover:bg-emerald-600">
                                    <i class="fas fa-utensils mr-1"></i> Food
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="sports" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-brand-highlight peer-checked:text-white peer-checked:border-brand-highlight transition hover:bg-slate-50 peer-checked:hover:bg-rose-600">
                                    <i class="fas fa-basketball-ball mr-1"></i> Sports
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="nature" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-teal-500 peer-checked:text-white peer-checked:border-teal-500 transition hover:bg-slate-50 peer-checked:hover:bg-teal-600">
                                    <i class="fas fa-leaf mr-1"></i> Nature
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="shopping" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-pink-500 peer-checked:text-white peer-checked:border-pink-500 transition hover:bg-slate-50 peer-checked:hover:bg-pink-600">
                                    <i class="fas fa-shopping-bag mr-1"></i> Shopping
                                </div>
                            </label>
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="adventure" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-orange-500 peer-checked:text-white peer-checked:border-orange-500 transition hover:bg-slate-50 peer-checked:hover:bg-orange-600">
                                    <i class="fas fa-hiking mr-1"></i> Adventure
                                </div>
                            </label>
                             <label class="cursor-pointer select-none">
                                <input type="checkbox" name="interest" value="relaxation" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-cyan-500 peer-checked:text-white peer-checked:border-cyan-500 transition hover:bg-slate-50 peer-checked:hover:bg-cyan-600">
                                    <i class="fas fa-spa mr-1"></i> Relaxation
                                </div>
                            </label>
                            <label class="cursor-pointer select-none" id="nightlife-option">
                                <input type="checkbox" name="interest" value="nightlife" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-indigo-500 peer-checked:text-white peer-checked:border-indigo-500 transition hover:bg-slate-50 peer-checked:hover:bg-indigo-600">
                                    <i class="fas fa-cocktail mr-1"></i> Nightlife
                                </div>
                            </label>
                            <!-- Custom Interest -->
                            <label class="cursor-pointer select-none">
                                <input type="checkbox" id="custom-interest-check" onchange="toggleCustomInterest()" class="peer sr-only">
                                <div class="px-4 py-2 rounded-full border border-slate-300 text-slate-600 peer-checked:bg-purple-500 peer-checked:text-white peer-checked:border-purple-500 transition hover:bg-slate-50 peer-checked:hover:bg-purple-600">
                                    <i class="fas fa-plus mr-1"></i> Specific Interest?
                                </div>
                            </label>
                        </div>
                        
                        <div id="custom-interest-container" class="hidden-input">
                            <input type="text" id="custom-interest-val" placeholder="Enter Interest (e.g. Anime, Architecture)" class="w-full px-4 py-2 rounded-lg border border-slate-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-slate-50">
                        </div>
                    </div>

                    <button onclick="generateItinerary()" class="w-full bg-brand-dark hover:bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg transition transform active:scale-95 flex justify-center items-center gap-2 text-lg">
                        <i class="fas fa-magic"></i> Generate My Itinerary
                    </button>
                </div>
            </div>
        </section>

        <!-- Loading View -->
        <section id="loading-view" class="hidden py-24 text-center">
            <div class="flex flex-col items-center justify-center">
                <div class="loader mb-6"></div>
                <h3 class="text-2xl font-bold text-slate-700 mb-2">Building your dream trip...</h3>
                <p class="text-slate-500" id="loading-text">Checking official ticket availability...</p>
            </div>
        </section>

        <!-- Results View -->
        <section id="results-view" class="hidden max-w-6xl mx-auto px-4 py-12">
            <div class="flex flex-col md:flex-row justify-between items-end mb-10 border-b border-slate-200 pb-6">
                <div>
                    <div class="text-sm font-bold text-brand-accent uppercase tracking-wider mb-1">Your Personal Plan</div>
                    <h2 class="text-4xl font-serif font-bold text-slate-800" id="result-title">Trip to Paris</h2>
                    <p class="text-slate-500 mt-2" id="result-subtitle">5 Days • Food & Culture Focus</p>
                </div>
                <button onclick="resetApp()" class="mt-4 md:mt-0 px-6 py-2 bg-white border border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-brand-dark transition shadow-sm text-sm font-bold">
                    <i class="fas fa-redo-alt mr-2"></i> Start Over
                </button>
            </div>
            <div id="itinerary-container" class="space-y-12"></div>
        </section>
    </main>

    <footer class="bg-white border-t border-slate-200 py-8 text-center text-slate-400 text-sm">
        <p>&copy; 2025 Ultimate Destination. Pricing and availability subject to change.</p>
    </footer>

    <script>
        // --- DATA MOCKUP ---
        
        // Helper to get random item from array
        const getRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];
        
        const shuffle = (array) => {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // Expanded Database with Real Links
        const db = {
            "new-york": {
                name: "New York City",
                teams: [{ home: "NY Knicks", venue: "MSG", league: "NBA" }],
                activities: {
                    culture: [
                        { name: "The Met", cost: "$30", hours: "10am-5pm", link: "https://www.metmuseum.org/", desc: "World-class art collection." },
                        { name: "Guggenheim Museum", cost: "$25", hours: "11am-6pm", link: "https://www.guggenheim.org/", desc: "Architectural masterpiece." },
                        { name: "Intrepid Museum", cost: "$33", hours: "10am-5pm", link: "https://www.intrepidmuseum.org/", desc: "Aircraft carrier & space shuttle." }
                    ],
                    food: [
                        { name: "Katz's Deli", cost: "$25", hours: "8am-11pm", link: "https://katzsdelicatessen.com/", desc: "Iconic pastrami sandwiches." },
                        { name: "Chelsea Market", cost: "Free Entry", hours: "7am-10pm", link: "https://www.chelseamarket.com/", desc: "Indoor food hall." },
                        { name: "Joe's Pizza", cost: "$5", hours: "10am-3am", link: "https://www.joespizzanyc.com/", desc: "Classic NY slice." }
                    ],
                    nature: [
                        { name: "Central Park", cost: "Free", hours: "6am-1am", link: "https://www.centralparknyc.org/", desc: "Urban oasis in Manhattan." },
                        { name: "The High Line", cost: "Free", hours: "7am-10pm", link: "https://www.thehighline.org/", desc: "Elevated park on rail line." },
                        { name: "Brooklyn Botanic Garden", cost: "$18", hours: "8am-6pm", link: "https://www.bbg.org/", desc: "Peaceful gardens." }
                    ],
                    history: [
                        { name: "Statue of Liberty", cost: "$24", hours: "9am-5pm", link: "https://www.nps.gov/stli/", desc: "Symbol of freedom." },
                        { name: "9/11 Memorial", cost: "Free", hours: "9am-8pm", link: "https://www.911memorial.org/", desc: "Memorial pools." },
                        { name: "Ellis Island", cost: "$24", hours: "9am-5pm", link: "https://www.nps.gov/elis/", desc: "Immigration history." }
                    ],
                    shopping: [
                        { name: "SoHo Shopping", cost: "Varied", hours: "10am-8pm", link: "https://www.sohonyc.com/", desc: "Trendy boutiques." },
                        { name: "Rockefeller Center", cost: "Varied", hours: "24h", link: "https://www.rockefellercenter.com/", desc: "Shops and plaza." },
                        { name: "Macy's Herald Square", cost: "Varied", hours: "10am-9pm", link: "https://www.macys.com/", desc: "World's largest store." }
                    ],
                    adventure: [
                        { name: "The Edge", cost: "$40", hours: "10am-10pm", link: "https://www.edgenyc.com/", desc: "Highest outdoor sky deck." },
                        { name: "Helicopter Tour", cost: "$200+", hours: "Daytime", link: "https://www.zipaviation.com/", desc: "Skyline views." }
                    ],
                    relaxation: [
                         { name: "Aire Ancient Baths", cost: "$150+", hours: "9am-11pm", link: "https://beaire.com/en/aire-ancient-baths-new-york", desc: "Luxury thermal baths." },
                         { name: "Bryant Park", cost: "Free", hours: "7am-10pm", link: "https://bryantpark.org/", desc: "Relax on the lawn." }
                    ],
                    nightlife: [
                        { name: "Broadway Show", cost: "$100+", hours: "7pm", link: "https://www.broadway.com/", desc: "World-famous theater." },
                        { name: "Times Square", cost: "Free", hours: "24h", link: "https://www.timessquarenyc.org/", desc: "Bright lights." }
                    ]
                }
            },
            "paris": {
                name: "Paris",
                teams: [{ home: "PSG", venue: "Parc des Princes", league: "Ligue 1" }],
                activities: {
                    culture: [
                        { name: "Louvre Museum", cost: "€17", hours: "9am-6pm", link: "https://www.louvre.fr/en", desc: "Home of Mona Lisa." },
                        { name: "Musée d'Orsay", cost: "€16", hours: "9:30am-6pm", link: "https://www.musee-orsay.fr/en", desc: "Impressionist art." },
                        { name: "Sainte-Chapelle", cost: "€11.50", hours: "9am-5pm", link: "https://www.sainte-chapelle.fr/en/", desc: "Stunning stained glass." }
                    ],
                    food: [
                        { name: "Café de Flore", cost: "€15", hours: "7am-1am", link: "https://cafedeflore.fr/", desc: "Historic cafe." },
                        { name: "Berthillon", cost: "€5", hours: "10am-8pm", link: "https://berthillon.fr/", desc: "Famous ice cream." },
                        { name: "Rue Mouffetard Market", cost: "Free", hours: "Mornings", link: "https://en.parisinfo.com/", desc: "Street market." }
                    ],
                    history: [
                        { name: "Versailles", cost: "€20", hours: "9am-6pm", link: "https://en.chateauversailles.fr/", desc: "Royal palace." },
                        { name: "Arc de Triomphe", cost: "€13", hours: "10am-10pm", link: "https://www.paris-arc-de-triomphe.fr/en/", desc: "Panoramic views." },
                        { name: "Notre-Dame (Exterior)", cost: "Free", hours: "24h", link: "https://www.notredamedeparis.fr/", desc: "Gothic cathedral." }
                    ],
                    nature: [
                         { name: "Jardin des Tuileries", cost: "Free", hours: "7am-9pm", link: "https://en.parisinfo.com/", desc: "Central garden." },
                         { name: "Buttes-Chaumont", cost: "Free", hours: "7am-8pm", link: "https://en.parisinfo.com/", desc: "Hillside park." }
                    ],
                    shopping: [
                        { name: "Galeries Lafayette", cost: "Free", hours: "10am-8pm", link: "https://haussmann.galerieslafayette.com/en/", desc: "Grand department store." },
                        { name: "Le Marais Boutiques", cost: "Varied", hours: "11am-7pm", link: "https://en.parisinfo.com/", desc: "Trendy shopping." }
                    ],
                    adventure: [
                        { name: "Catacombs", cost: "€29", hours: "10am-8pm", link: "https://www.catacombes.paris.fr/en", desc: "Underground tunnels." },
                        { name: "Eiffel Tower Summit", cost: "€28", hours: "9am-11pm", link: "https://www.toureiffel.paris/en", desc: "Top floor views." }
                    ],
                    relaxation: [
                        { name: "Jardin du Luxembourg", cost: "Free", hours: "Dawn-Dusk", link: "https://en.parisinfo.com/", desc: "Peaceful gardens." },
                        { name: "Seine River Cruise", cost: "€15", hours: "Every hour", link: "https://www.bateaux-mouches.fr/en", desc: "Relaxing boat ride." }
                    ],
                    nightlife: [
                        { name: "Moulin Rouge", cost: "€100+", hours: "9pm", link: "https://www.moulinrouge.fr/en/", desc: "Cabaret show." },
                        { name: "Seine Picnic", cost: "Free", hours: "Evening", link: "https://en.parisinfo.com/", desc: "Sunset by the river." }
                    ]
                }
            },
            "las-vegas": {
                name: "Las Vegas",
                teams: [{ home: "Raiders", venue: "Allegiant Stadium", league: "NFL" }],
                activities: {
                    culture: [
                        { name: "Cirque du Soleil", cost: "$100+", hours: "7pm/9pm", link: "https://www.cirquedusoleil.com/las-vegas", desc: "World-famous acrobatics." },
                        { name: "Neon Museum", cost: "$20", hours: "2pm-10pm", link: "https://www.neonmuseum.org/", desc: "Vintage sign graveyard." }
                    ],
                    food: [
                        { name: "Bacchanal Buffet", cost: "$80", hours: "9am-10pm", link: "https://www.caesars.com/caesars-palace/restaurants/bacchanal-buffet", desc: "Massive luxury buffet." },
                        { name: "Eataly Las Vegas", cost: "Varied", hours: "11am-11pm", link: "https://www.eataly.com/us_en/stores/las-vegas/", desc: "Italian marketplace." },
                        { name: "Gordon Ramsay Burger", cost: "$25", hours: "11am-11pm", link: "https://www.gordonramsayrestaurants.com/", desc: "Gourmet burgers." }
                    ],
                    nature: [
                        { name: "Red Rock Canyon", cost: "$15", hours: "8am-5pm", link: "https://www.redrockcanyonlv.org/", desc: "Desert hiking nearby." },
                        { name: "Valley of Fire", cost: "$10", hours: "Sunrise-Sunset", link: "http://parks.nv.gov/parks/valley-of-fire", desc: "Red sandstone formations." }
                    ],
                    adventure: [
                        { name: "High Roller Wheel", cost: "$30", hours: "12pm-12am", link: "https://www.caesars.com/linq/high-roller", desc: "Giant observation wheel." },
                        { name: "SlotZilla Zip Line", cost: "$40+", hours: "1pm-1am", link: "https://vegasexperience.com/slotzilla-zip-line/", desc: "Fly over Fremont St." },
                        { name: "Big Apple Coaster", cost: "$19", hours: "11am-11pm", link: "https://newyorknewyork.mgmresorts.com/", desc: "Roller coaster on the strip." }
                    ],
                    relaxation: [
                        { name: "Bellagio Fountains", cost: "Free", hours: "3pm-12am", link: "https://bellagio.mgmresorts.com/", desc: "Water show set to music." },
                        { name: "Mandalay Bay Beach", cost: "Entry varies", hours: "9am-6pm", link: "https://mandalaybay.mgmresorts.com/", desc: "Wave pool and beach." }
                    ],
                    shopping: [
                         { name: "Forum Shops", cost: "Varied", hours: "10am-9pm", link: "https://www.simon.com/mall/the-forum-shops-at-caesars-palace", desc: "High-end mall." },
                         { name: "Premium Outlets", cost: "Varied", hours: "10am-8pm", link: "https://www.premiumoutlets.com/", desc: "Discount shopping." }
                    ],
                    nightlife: [
                        { name: "Fremont Street", cost: "Free", hours: "24h", link: "https://vegasexperience.com/", desc: "Light shows and performers." },
                        { name: "The Sphere", cost: "$90+", hours: "Shows daily", link: "https://www.thespherevegas.com/", desc: "Immersive entertainment." }
                    ]
                }
            },
            "honolulu": {
                name: "Honolulu",
                teams: [],
                activities: {
                    culture: [
                        { name: "Pearl Harbor", cost: "Free", hours: "7am-5pm", link: "https://www.nps.gov/valr/index.htm", desc: "Historic memorial site." },
                        { name: "Iolani Palace", cost: "$25", hours: "9am-4pm", link: "https://www.iolanipalace.org/", desc: "Royal residence." },
                        { name: "Bishop Museum", cost: "$25", hours: "9am-5pm", link: "https://www.bishopmuseum.org/", desc: "Hawaiian history." }
                    ],
                    food: [
                        { name: "Leonard's Bakery", cost: "$5", hours: "5am-10pm", link: "https://www.leonardshawaii.com/", desc: "Famous for Malasadas." },
                        { name: "Duke's Waikiki", cost: "$30", hours: "7am-11pm", link: "https://www.dukeswaikiki.com/", desc: "Beachfront dining." },
                        { name: "Giovanni's Shrimp", cost: "$15", hours: "10am-5pm", link: "http://giovannisshrimptruck.com/", desc: "Famous shrimp truck." }
                    ],
                    nature: [
                        { name: "Diamond Head", cost: "$5", hours: "6am-6pm", link: "https://dlnr.hawaii.gov/dsp/parks/oahu/diamond-head-state-monument/", desc: "Volcanic crater hike." },
                        { name: "Manoa Falls", cost: "Free", hours: "Sunrise-Sunset", link: "https://dlnr.hawaii.gov/", desc: "Rainforest waterfall hike." },
                        { name: "Hanauma Bay", cost: "$25", hours: "7am-4pm", link: "https://www.hanaumabaystatepark.com/", desc: "Snorkeling preserve." }
                    ],
                    relaxation: [
                        { name: "Waikiki Beach", cost: "Free", hours: "24h", link: "https://www.gohawaii.com/", desc: "Iconic surfing beach." },
                        { name: "Lanikai Beach", cost: "Free", hours: "Daytime", link: "https://www.gohawaii.com/", desc: "Soft sand and clear water." }
                    ],
                    shopping: [
                        { name: "Ala Moana Center", cost: "Varied", hours: "10am-8pm", link: "https://www.alamoanacenter.com/", desc: "Largest open-air mall." },
                        { name: "International Market", cost: "Varied", hours: "10am-10pm", link: "https://shopinternationalmarketplace.com/", desc: "Shopping in Waikiki." }
                    ],
                    adventure: [
                        { name: "Surf Lessons", cost: "$100", hours: "Morning", link: "https://www.waikikibeachservices.com/", desc: "Learn to surf." },
                        { name: "Parasailing", cost: "$90", hours: "9am-5pm", link: "https://h2osportshawaii.com/", desc: "Fly over the ocean." }
                    ]
                }
            },
            "toronto": {
                name: "Toronto",
                teams: [{ home: "Blue Jays", venue: "Rogers Centre", league: "MLB" }],
                activities: {
                    culture: [
                        { name: "CN Tower", cost: "$45", hours: "9am-9pm", link: "https://www.cntower.ca/", desc: "Iconic skyline views." },
                        { name: "Royal Ontario Museum", cost: "$23", hours: "10am-5:30pm", link: "https://www.rom.on.ca/en", desc: "Art, culture, and nature." },
                        { name: "Art Gallery of Ontario", cost: "$25", hours: "10:30am-5pm", link: "https://ago.ca/", desc: "Large art museum." }
                    ],
                    food: [
                        { name: "St. Lawrence Market", cost: "Free Entry", hours: "9am-5pm", link: "http://www.stlawrencemarket.com/", desc: "Historic food market." },
                        { name: "Kensington Market", cost: "Free", hours: "10am-7pm", link: "https://kensington-market.ca/", desc: "Eclectic food neighborhood." },
                        { name: "Distillery District", cost: "Varied", hours: "10am-9pm", link: "https://www.thedistillerydistrict.com/", desc: "Dining in historic buildings." }
                    ],
                    history: [
                        { name: "Casa Loma", cost: "$30", hours: "9:30am-5pm", link: "https://casaloma.ca/", desc: "Gothic revival castle." },
                        { name: "Fort York", cost: "$14", hours: "10am-4pm", link: "https://www.toronto.ca/fort-york/", desc: "War of 1812 site." }
                    ],
                    nature: [
                        { name: "Toronto Islands", cost: "$9 (Ferry)", hours: "8am-11pm", link: "https://www.toronto.ca/islands/", desc: "Parkland accessible by ferry." },
                        { name: "High Park", cost: "Free", hours: "24h", link: "https://www.highparktoronto.com/", desc: "Large park with zoo." }
                    ],
                    shopping: [
                        { name: "Eaton Centre", cost: "Varied", hours: "10am-9pm", link: "https://www.cfshops.com/toronto-eaton-centre.html", desc: "Massive downtown mall." },
                        { name: "Yorkville", cost: "Varied", hours: "10am-6pm", link: "https://www.bloor-yorkville.com/", desc: "Luxury shopping district." }
                    ],
                    adventure: [
                        { name: "EdgeWalk", cost: "$195", hours: "Seasonal", link: "https://www.cntower.ca/edgewalk", desc: "Walk outside the CN Tower." },
                        { name: "Ripley's Aquarium", cost: "$44", hours: "9am-9pm", link: "https://www.ripleyaquariums.com/canada/", desc: "Walk-through shark tunnel." }
                    ]
                }
            },
            "berlin": {
                name: "Berlin",
                teams: [{ home: "Hertha BSC", venue: "Olympiastadion", league: "Bundesliga" }],
                activities: {
                    culture: [
                        { name: "Museum Island", cost: "€19", hours: "10am-6pm", link: "https://www.smb.museum/", desc: "UNESCO World Heritage site." },
                        { name: "East Side Gallery", cost: "Free", hours: "24h", link: "https://www.eastsidegallery-berlin.com/", desc: "Art on the Berlin Wall." },
                        { name: "Reichstag Building", cost: "Free (Book ahead)", hours: "8am-12am", link: "https://www.bundestag.de/en/visitthebundestag", desc: "Glass dome views." }
                    ],
                    history: [
                        { name: "Brandenburg Gate", cost: "Free", hours: "24h", link: "https://www.berlin.de/en/", desc: "Symbol of unity." },
                        { name: "Checkpoint Charlie", cost: "Free", hours: "24h", link: "https://www.berlin.de/en/attractions/", desc: "Cold War crossing point." },
                        { name: "Memorial to Jews", cost: "Free", hours: "24h", link: "https://www.stiftung-denkmal.de/en/", desc: "Holocaust memorial." }
                    ],
                    food: [
                        { name: "Curry 36", cost: "€5", hours: "9am-5am", link: "https://curry36.de/", desc: "Famous Currywurst." },
                        { name: "Markthalle Neun", cost: "Free Entry", hours: "Varied", link: "https://markthalleneun.de/", desc: "Street food market." }
                    ],
                    nature: [
                         { name: "Tiergarten", cost: "Free", hours: "24h", link: "https://www.berlin.de/en/parks-and-gardens/", desc: "Central massive park." },
                         { name: "Tempelhofer Feld", cost: "Free", hours: "6am-Sunset", link: "https://gruen-berlin.de/tempelhofer-feld", desc: "Park on old airport." }
                    ],
                    shopping: [
                         { name: "Kurfürstendamm", cost: "Varied", hours: "10am-8pm", link: "https://www.visitberlin.de/en", desc: "Famous shopping avenue." },
                         { name: "KaDeWe", cost: "Varied", hours: "10am-8pm", link: "https://www.kadewe.de/", desc: "Luxury department store." }
                    ],
                    nightlife: [
                        { name: "Berghain", cost: "€25", hours: "Late", link: "https://www.berghain.berlin/", desc: "World famous techno club (Adults)." },
                        { name: "Prater Beer Garden", cost: "Varied", hours: "12pm-11pm", link: "https://www.pratergarten.de/", desc: "Oldest beer garden." }
                    ]
                }
            },
            "seoul": {
                name: "Seoul",
                teams: [],
                activities: {
                    culture: [
                        { name: "Gyeongbokgung Palace", cost: "₩3,000", hours: "9am-5pm", link: "http://www.royalpalace.go.kr/", desc: "Main royal palace." },
                        { name: "Bukchon Hanok Village", cost: "Free", hours: "9am-5pm", link: "https://english.visitkorea.or.kr/", desc: "Traditional houses." },
                        { name: "N Seoul Tower", cost: "₩16,000", hours: "10am-11pm", link: "https://www.nseoultower.co.kr/eng/", desc: "City views." }
                    ],
                    food: [
                        { name: "Myeongdong Street Food", cost: "Cheap", hours: "5pm-11pm", link: "https://english.visitkorea.or.kr/", desc: "Diverse street snacks." },
                        { name: "Gwangjang Market", cost: "Cheap", hours: "9am-6pm", link: "https://english.visitkorea.or.kr/", desc: "Traditional food market." },
                        { name: "Korean BBQ", cost: "₩30,000+", hours: "Evening", link: "#", desc: "Grill your own meat." }
                    ],
                    shopping: [
                        { name: "Dongdaemun Design Plaza", cost: "Free", hours: "10am-9pm", link: "https://ddp.or.kr/", desc: "Futuristic design hub." },
                        { name: "Hongdae", cost: "Varied", hours: "10am-10pm", link: "https://english.visitkorea.or.kr/", desc: "Youth fashion & art." },
                        { name: "Starfield COEX Mall", cost: "Varied", hours: "10:30am-10pm", link: "https://www.starfield.co.kr/coexmall/main.do", desc: "Giant underground mall." }
                    ],
                    nature: [
                         { name: "Cheonggyecheon Stream", cost: "Free", hours: "24h", link: "https://english.visitkorea.or.kr/", desc: "Urban stream walk." },
                         { name: "Han River Park", cost: "Free", hours: "24h", link: "https://english.visitkorea.or.kr/", desc: "Riverside picnics." }
                    ],
                    adventure: [
                         { name: "Lotte World", cost: "₩59,000", hours: "10am-9pm", link: "https://www.lotteworld.com/", desc: "Indoor theme park." }
                    ],
                    relaxation: [
                        { name: "Dragon Hill Spa", cost: "₩15,000", hours: "24h", link: "https://www.dragonhillspa.com/", desc: "Traditional Jimjilbang." }
                    ]
                }
            }
        };
        
        // Populate missing properties for robust fallback
        Object.keys(db).forEach(city => {
            if(!db[city].activities.history) db[city].activities.history = db[city].activities.culture;
            if(!db[city].activities.relaxation) db[city].activities.relaxation = db[city].activities.nature;
            if(!db[city].activities.adventure) db[city].activities.adventure = db[city].activities.nature;
            if(!db[city].activities.shopping) db[city].activities.shopping = [{ name: "City Center", cost: "Varied", hours: "10am-8pm", link: "#", desc: "Local shops." }];
            if(!db[city].activities.nightlife) db[city].activities.nightlife = [{ name: "City Night Walk", cost: "Free", hours: "Evening", link: "#", desc: "Enjoy the city lights." }];
        });

        // --- UI LOGIC ---

        function toggleCustomDest() {
            const val = document.getElementById('destination').value;
            const container = document.getElementById('custom-dest-container');
            container.classList.toggle('show', val === 'custom');
        }

        function toggleCustomInterest() {
            const checked = document.getElementById('custom-interest-check').checked;
            const container = document.getElementById('custom-interest-container');
            container.classList.toggle('show', checked);
        }

        function toggleNightlife() {
            const ageGroup = document.getElementById('age-group').value;
            const nightlifeOption = document.getElementById('nightlife-option');
            const nightlifeInput = nightlifeOption.querySelector('input');
            
            // If family selected, uncheck and hide Nightlife to keep it safe
            if(ageGroup === 'family') {
                nightlifeInput.checked = false;
                nightlifeOption.classList.add('opacity-50', 'pointer-events-none');
            } else {
                nightlifeOption.classList.remove('opacity-50', 'pointer-events-none');
            }
        }
        
        // Initialize Date Input to Today
        document.getElementById('start-date').valueAsDate = new Date();

        function resetApp() {
            document.getElementById('input-section').classList.remove('hidden');
            document.getElementById('results-view').classList.add('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function getCityData(key, customName) {
            if (db[key]) return db[key];
            const cleanName = customName || "Mystery City";
            // Generic fallback
            return {
                name: cleanName,
                teams: [],
                activities: {
                    culture: [{ name: `${cleanName} Museum`, cost: "$20", hours: "10am-5pm", link: `https://google.com/search?q=${cleanName}+museum`, desc: "Local history." }],
                    food: [{ name: "Downtown Dining", cost: "Varied", hours: "11am-10pm", link: `https://google.com/search?q=${cleanName}+restaurants`, desc: "Local flavors." }],
                    nature: [{ name: "City Park", cost: "Free", hours: "Dawn-Dusk", link: `https://google.com/search?q=${cleanName}+parks`, desc: "Green space." }],
                    history: [{ name: "Old Town", cost: "Free", hours: "24h", link: `https://google.com/search?q=${cleanName}+old+town`, desc: "Historic center." }],
                    relaxation: [{ name: "Local Spa", cost: "$50+", hours: "9am-9pm", link: `https://google.com/search?q=${cleanName}+spa`, desc: "Relax and unwind." }],
                    shopping: [{ name: "Main Street", cost: "Varied", hours: "10am-9pm", link: `https://google.com/search?q=${cleanName}+shopping`, desc: "Shopping district." }],
                    adventure: [{ name: "City Tour", cost: "$30", hours: "10am", link: `https://google.com/search?q=${cleanName}+tours`, desc: "Guided tour." }],
                    nightlife: [{ name: "Evening Plaza", cost: "Free", hours: "Evening", link: `https://google.com/search?q=${cleanName}+nightlife`, desc: "Evening atmosphere." }]
                }
            };
        }

        // --- GENERATOR LOGIC ---

        function generateItinerary() {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('results-view').classList.add('hidden');
            document.getElementById('loading-view').classList.remove('hidden');
            
            setTimeout(() => {
                buildItinerary();
                document.getElementById('loading-view').classList.add('hidden');
                document.getElementById('results-view').classList.remove('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 1500);
        }

        function buildItinerary() {
            const destSelect = document.getElementById('destination').value;
            const customCityName = document.getElementById('custom-dest-val').value;
            const days = parseInt(document.getElementById('duration').value);
            const budget = document.getElementById('budget').value;
            const ageGroup = document.getElementById('age-group').value;
            const startDateVal = document.getElementById('start-date').value;
            
            let selectedInterests = Array.from(document.querySelectorAll('input[name="interest"]:checked')).map(el => el.value);
            
            // Age Safety Check
            if (ageGroup === 'family') {
                selectedInterests = selectedInterests.filter(i => i !== 'nightlife');
                if(selectedInterests.length === 0) selectedInterests.push('nature', 'culture');
            }

            const customInterestCheck = document.getElementById('custom-interest-check').checked;
            const customInterestVal = document.getElementById('custom-interest-val').value;
            if (customInterestCheck && customInterestVal) selectedInterests.push('custom');
            if (selectedInterests.length === 0) selectedInterests.push('culture', 'food');

            const cityData = getCityData(destSelect, customCityName);
            const startDate = new Date(startDateVal);

            // Display Header
            document.getElementById('result-title').innerText = `Trip to ${cityData.name}`;
            document.getElementById('result-subtitle').innerText = `${days} Days • ${ageGroup.charAt(0).toUpperCase() + ageGroup.slice(1)} Trip • ${budget.charAt(0).toUpperCase() + budget.slice(1)}`;

            const container = document.getElementById('itinerary-container');
            container.innerHTML = '';

            for (let i = 0; i < days; i++) {
                // Calculate Real Date
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i + 1);
                const options = { weekday: 'long', month: 'short', day: 'numeric' };
                const dateString = currentDate.toLocaleDateString('en-US', options);

                const dayHTML = document.createElement('div');
                dayHTML.className = "relative border-l-4 border-slate-200 pl-8 pb-8";
                
                const dayMarker = `
                    <div class="absolute -left-3 top-0 bg-brand-accent text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border-4 border-white shadow-md">
                        ${i + 1}
                    </div>
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold text-slate-800">Day ${i + 1}</h3>
                        <p class="text-slate-500 font-medium">${dateString}</p>
                    </div>
                `;

                // Build Pool
                let mainPool = [];
                selectedInterests.forEach(interest => {
                    if(interest === 'custom') {
                        mainPool.push({
                            name: `${customInterestVal} Spot`,
                            cost: "Varied",
                            hours: "Daytime",
                            link: `https://google.com/search?q=${cityData.name}+${customInterestVal}`,
                            desc: `Exploring ${customInterestVal} in ${cityData.name}.`
                        });
                    } else if (cityData.activities[interest]) {
                        mainPool.push(...cityData.activities[interest]);
                    }
                });
                
                // Shuffle and Pick
                const shuffledMain = shuffle([...mainPool]);
                let dailyActivities = [];
                
                // Activity Logic based on Age
                let count = 3;
                if(ageGroup === 'family') count = 2; // Relaxed pace for kids
                if(ageGroup === 'young-adult') count = 4; // Packed

                // Fill slots
                for(let k=0; k<count; k++) {
                    dailyActivities.push(shuffledMain[k % shuffledMain.length]);
                }

                // Sports insertion
                if (selectedInterests.includes('sports') && cityData.teams.length > 0 && Math.random() > 0.5) {
                    const team = getRandom(cityData.teams);
                    dailyActivities[dailyActivities.length - 1] = {
                        isSports: true,
                        name: `${team.home} Game`,
                        venue: team.venue,
                        cost: "$50+",
                        hours: "7:00 PM",
                        link: `https://www.ticketmaster.com/search?q=${team.home}`,
                        desc: `Live ${team.league} action.`
                    };
                }

                // Render Cards
                let cardsHTML = `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">`;
                const timeSlots = ["Morning", "Afternoon", "Evening", "Late Night"];

                dailyActivities.forEach((act, index) => {
                    if(!act) return;
                    const timeLabel = timeSlots[index] || "Activity";
                    
                    // Age Appropriate Filtering for Family
                    if (ageGroup === 'family' && act.desc && act.desc.toLowerCase().includes('club')) {
                        act.name = "Evening Light Show";
                        act.desc = "Safe and fun evening entertainment.";
                    }

                    cardsHTML += `
                        <div class="activity-card bg-white rounded-xl overflow-hidden shadow-sm border border-slate-100 flex flex-col">
                            <div class="p-5 flex-grow">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="bg-slate-100 text-slate-600 px-2 py-1 rounded text-xs font-bold uppercase">${timeLabel}</span>
                                    ${act.isSports ? '<span class="text-blue-600 text-xs font-bold"><i class="fas fa-trophy"></i> Sport</span>' : ''}
                                </div>
                                <h4 class="text-lg font-bold text-slate-800 mb-2 font-serif">${act.name}</h4>
                                <p class="text-slate-500 text-sm leading-relaxed mb-4">${act.desc}</p>
                                <div class="flex items-center gap-3 text-sm text-slate-600 mb-1">
                                    <i class="far fa-clock text-brand-accent w-4"></i> <span>${act.hours}</span>
                                </div>
                                <div class="flex items-center gap-3 text-sm text-slate-600">
                                    <i class="fas fa-wallet text-brand-accent w-4"></i> <span>${act.cost}</span>
                                </div>
                            </div>
                            <div class="bg-slate-50 p-4 border-t border-slate-100">
                                <a href="${act.link}" target="_blank" class="text-brand-accent hover:text-blue-700 font-bold text-sm flex items-center justify-between group">
                                    ${act.isSports ? 'Get Tickets' : 'Visit Website'}
                                    <i class="fas fa-external-link-alt group-hover:translate-x-1 transition-transform"></i>
                                </a>
                            </div>
                        </div>
                    `;
                });
                
                cardsHTML += `</div>`;
                dayHTML.innerHTML = dayMarker + cardsHTML;
                container.appendChild(dayHTML);
            }
        }
    </script>
</body>
</html>
